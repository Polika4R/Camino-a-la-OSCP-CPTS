
### Ubicación de Herramientas en máquinas de ataque
- **Hosts Windows de Ataque:** Directorio `C:\Tools`.
- **Hosts Linux de Ataque (Parrot OS):** Directorio `/opt` o preinstaladas.

### Herramientas Clave por Categoría

| **Categoría**                                   | **Herramienta**                             | **Descripción y Uso Principal**                                                                                                                                                                                 |
| ----------------------------------------------- | ------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Reconocimiento y Conciencia Situacional**     | **BloodHound**                              | Mapea visualmente relaciones y rutas de ataque en AD. Usa **SharpHound** o **BloodHound.py** para recolección de datos.                                                                                         |
|                                                 | **SharpHound**                              | Recolector de datos en C# para BloodHound (genera archivos JSON).                                                                                                                                               |
|                                                 | **BloodHound.py**                           | Recolector de datos en Python (basado en Impacket) para BloodHound.                                                                                                                                             |
|                                                 | **PowerView/SharpView**                     | Herramientas PowerShell/.NET para obtener conciencia situacional en AD (alternativa a comandos `net*`). Útil para buscar 'victorias rápidas' como usuarios atacables por **Kerberoasting** o **ASREPRoasting**. |
|                                                 | **ADRecon**                                 | Extrae varios datos de AD y los genera en formato Excel con análisis y resúmenes.                                                                                                                               |
|                                                 | **Active Directory Explorer (AD Explorer)** | Visor y editor de AD. Permite navegar, ver propiedades y guardar/comparar **instantáneas (snapshots)** de la base de datos de AD.                                                                               |
| **Ataques de Kerberos y Autenticación**         | **Rubeus**                                  | Herramienta C# para abuso de Kerberos.                                                                                                                                                                          |
|                                                 | **Kerbrute**                                | Herramienta Go para enumerar cuentas, realizar _password spraying_ y _brute-forcing_ usando **Kerberos Pre-Authentication**.                                                                                    |
|                                                 | **GetUserSPNs.py**                          | Módulo Impacket para encontrar **Service Principal Names (SPNs)** vinculados a usuarios normales (_Kerberoasting_).                                                                                             |
|                                                 | **GetNPUsers.py**                           | Módulo Impacket para realizar **ASREPRoasting** (obtener _AS-REP hashes_ de usuarios sin preautenticación).                                                                                                     |
|                                                 | **Mimikatz**                                | Extrae contraseñas en texto plano, _tickets_ Kerberos y realiza ataques _pass-the-hash_ desde la memoria del host.                                                                                              |
|                                                 | **ticketer.py**                             | Creación y personalización de _tickets_ **TGT/TGS** (ej. _Golden Ticket_).                                                                                                                                      |
| **Protocolos de Red y _Spoofing_**              | **Responder**                               | Herramienta dedicada a envenenar **LLMNR, NBT-NS y MDNS**.                                                                                                                                                      |
|                                                 | **Inveigh.ps1**                             | Herramienta PowerShell similar a Responder para ataques de _network spoofing_ y envenenamiento.                                                                                                                 |
|                                                 | **C# Inveigh (InveighZero)**                | Versión C# de Inveigh con consola semi-interactiva para gestionar datos capturados (ej. _hashes_).                                                                                                              |
| **Enumeración General y Post-Explotación**      | **Impacket toolkit**                        | Colección de herramientas Python para interactuar y atacar protocolos de red (fundamental para AD).                                                                                                             |
|                                                 | **CrackMapExec (CME)**                      | Toolkit de enumeración, ataque y post-explotación. Abusa de características y protocolos de AD como **SMB, WMI, WinRM y MSSQL**.                                                                                |
|                                                 | **enum4linux** / **enum4linux-ng**          | Herramientas para enumerar información de sistemas Windows y Samba.                                                                                                                                             |
|                                                 | **smbmap**                                  | Enumeración de recursos compartidos **SMB** a través de un dominio.                                                                                                                                             |
|                                                 | **ldapsearch**                              | Interfaz integrada para interactuar con el protocolo **LDAP**.                                                                                                                                                  |
|                                                 | **windapsearch**                            | Script Python para automatizar consultas **LDAP** de usuarios, grupos y equipos.                                                                                                                                |
|                                                 | **rpcinfo**                                 | Consulta el estado o enumera servicios **RPC** disponibles en un host remoto.                                                                                                                                   |
|                                                 | **rpcclient**                               | Herramienta de la suite Samba para realizar tareas de enumeración de AD a través de **RPC**.                                                                                                                    |
| **Ejecución Remota y Movimiento Lateral**       | **psexec.py**                               | Módulo Impacket que proporciona funcionalidad tipo **PsExec** con _shell_ semi-interactiva.                                                                                                                     |
|                                                 | **wmiexec.py**                              | Módulo Impacket para ejecución de comandos sobre **WMI**.                                                                                                                                                       |
|                                                 | **evil-winrm**                              | Proporciona un _shell_ interactivo sobre el protocolo **WinRM**.                                                                                                                                                |
|                                                 | **mssqlclient.py**                          | Módulo Impacket para interactuar con bases de datos **MSSQL**.                                                                                                                                                  |
| **Herramientas Específicas / Vulnerabilidades** | **Hashcat**                                 | Herramienta para _crackeo_ y recuperación de contraseñas (_hashes_).                                                                                                                                            |
|                                                 | **DomainPasswordSpray.ps1**                 | Herramienta PowerShell para realizar ataque de **password spray**.                                                                                                                                              |
|                                                 | **LAPSToolkit**                             | Funciones PowerShell (_PowerView_) para auditar y atacar entornos con **LAPS** (Local Administrator Password Solution).                                                                                         |
|                                                 | **Snaffler**                                | Útil para encontrar información sensible (ej. credenciales) en recursos compartidos de archivos accesibles en AD.                                                                                               |
|                                                 | **secretsdump.py**                          | Vuelca de forma remota secretos **SAM y LSA** de un host.                                                                                                                                                       |
|                                                 | **setspn.exe**                              | Herramienta nativa para añadir, leer, modificar o eliminar SPNs.                                                                                                                                                |
|                                                 | **gpp-decrypt**                             | Extrae usuarios y contraseñas de archivos de **Group Policy preferences (GPP)**.                                                                                                                                |
|                                                 | **adidnsdump**                              | Enumera y vuelca registros **DNS** (similar a una transferencia de zona DNS).                                                                                                                                   |
|                                                 | **noPac.py**                                | Exploit para **CVE-2021-42278** y **CVE-2021-42287** (suplantación de DA).                                                                                                                                      |
|                                                 | **PetitPotam.py**                           | PoC para **CVE-2021-36942** (coerción de autenticación a través de MS-EFSRPC).                                                                                                                                  |
|                                                 | **CVE-2021-1675.py**                        | PoC en Python para **Printnightmare**.                                                                                                                                                                          |
|                                                 | **ntlmrelayx.py**                           | Módulo Impacket que realiza ataques de **SMB relay**.                                                                                                                                                           |
| **Auditoría y Chequeo de Seguridad**            | **PingCastle**                              | Audita el nivel de seguridad de un entorno AD basado en un marco de evaluación de riesgos.                                                                                                                      |
|                                                 | **Group3r**                                 | Audita y encuentra malas configuraciones de seguridad en **Group Policy Objects (GPOs)**.                                                                                                                       |

### En MSFCONSOLE (msf > ...)

| Comando                                             | Descripción                                                                                                                                                                                                                                                                                                                        | Ejemplo                                    |
| --------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------ |
| grep <palabra_1> grep <palabra_2> show  \<payloads> | Filtra y muestra información en la salida: grep <palabra_1> selecciona líneas que contienen `palabra_1`; encadenando grep <palabra_2> afinas aún más la búsqueda. show \<payloads> lista los payloads disponibles en el contexto (por ejemplo dentro de Metasploit). Útil para localizar información relevante en listados largos. |                                            |
| search <cve / palabra clave>                        | Para buscar módulos concretos de metasploit                                                                                                                                                                                                                                                                                        | search CVE-2017-7269                       |
| use <nº_índice>                                     | Para usar un módulo buscado anteriormente con "search <...>"                                                                                                                                                                                                                                                                       | use 0 (o el índice que del módulo deseado) |
| options                                             | Para ver las opciones de un módulo seleccionado                                                                                                                                                                                                                                                                                    |                                            |
| setg RHOST 1.2.3.4                                  | Para hacer que el RHOST marcado sea persistente entre módulos                                                                                                                                                                                                                                                                      |                                            |
| set RHOST / LPORT / SESSION / ....                  | Para establecer parámetros del módulo. Seleccionar correctamente el LPORT. Este, tiene que estar en la misma red que la víctima.                                                                                                                                                                                                   |                                            |
| run // exploit                                      | Para lanzar el módulo                                                                                                                                                                                                                                                                                                              |                                            |

### En una sesión METERPRETER (meterpreter > ...)

| Comando                                  | Descripción                                                                                                                                                                       | Ejemplo       |
| ---------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------- |
| background // bg                         | Para enviar a background la sesión de meterpreter creada                                                                                                                          |               |
| meterpreter > sessions (o "sessions -l") | Para listar las sesiones de meterpreter existentes puestas en background                                                                                                          |               |
| meterpreter > sessions - i <nº_sesion>   | Para reestablecer el uso de la sesión <nº_sesión> puesta en background                                                                                                            | sessions -i 1 |
| meterpreter > getuid                     | Muestra, a alto nivel, la identidad (usuario) con la que corre el proceso del agente Meterpreter en la máquina objetivo. Útil para saber el contexto de permisos.                 |               |
| meterpreter > ps                         | Lista procesos que se están ejecutando en el sistema objetivo desde la vista del agente Meterpreter. Se usa para inspeccionar procesos activos y localizar procesos interesantes. |               |
| meterpreter > steal_token 1836           | Permite al agente intentar usar un token de acceso (privilegio) de otro proceso/usuario para impersonación o escalado en sistemas Windows.                                        |               |
| meterpreter > hashdump                   | Extrae hashes de contraseñas almacenados en el sistema                                                                                                                            |               |
| meterpreter > lsa_dump_sam               | Extrae información sensible desde el subsistema de seguridad (LSA/SAM) en Windows                                                                                                 |               |
| - meterpreter > lsa_dump_secrets         | Intenta recuperar secretos almacenados por el LSA                                                                                                                                 |               |

### Sobre los módulos (msf > \(nombre_módulo) ...)

| Comando       | Descripción                                                                                                                                                                           | Ejemplo |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------- |
| options       | Muestra tanto el payload como el target que utilizará el módulo. Estos se pueden editar                                                                                               |         |
| show payloads | Muestra el conjunto de payloads disponibles con el módulo seleccionado. Podemos escoger otro payload haciendo uso de "use <num_índice_payload>"                                       |         |
| show targets  | Muestra el abanico de targets posibles (diferentes versiones de SO, navegadores, ...) a los que el módulo puede atacar. Podemos escoger otro target haciendo uso de "use <num_target" |         |
|               |                                                                                                                                                                                       |         |

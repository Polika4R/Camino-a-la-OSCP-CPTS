|Comando / Herramienta|Descripción (qué hace / por qué es útil)|Ejemplo (uso concreto)|
|--:|---|---|
|`crackmapexec smb <host> -u <user> -p <pass> --pass-pol`|Obtiene la política de contraseñas del dominio cuando dispones de credenciales. Muestra `Minimum password length`, `Password history`, `Lockout` y flags de complejidad. Muy útil para determinar límites antes de ataques de password spraying / brute-force controlados.|`crackmapexec smb 172.16.5.5 -u avazquez -p Password123 --pass-pol`|
|`rpcclient -U "" -N <DC>` + `querydominfo` / `getdompwinfo`|Conexión RPC/SAMR (sesión nula permitida) para consultar info del dominio y política de contraseñas. `querydominfo` muestra datos generales; `getdompwinfo` muestra atributos de la política. Útil para entornos donde se permiten null sessions.|`rpcclient -U "" -N 172.16.5.5` → `rpcclient $> querydominfo` y `rpcclient $> getdompwinfo`|
|`enum4linux -P <host>`|Herramienta de enumeración SMB/RPC que intenta sesiones nulas y extrae la política de contraseñas, usuarios, shares, etc. Salida legible para análisis rápido desde Linux.|`enum4linux -P 172.16.5.5`|
|`enum4linux-ng -P <host> -oA <prefijo>`|Reescritura moderna de enum4linux en Python; puede exportar JSON/YAML (`-oA`) y extraer políticas y datos SMB/RPC con salida estructurada para procesamiento automático.|`enum4linux-ng -P 172.16.5.5 -oA ilfreight`|
|`cat <archivo>.json` (salida de enum4linux-ng)|Mostrar/parsear el JSON generado para automatizar ingestión de políticas y metadatos (hosts, dialectos SMB, null session possible, etc.).|`cat ilfreight.json`|
|`ldapsearch -h <DC> -x -b "DC=dom,DC=local" -s sub "*"` + `grep pwdHistoryLength`|Usar LDAP (Anonymous Bind con `-x`) para extraer atributos de dominio si el LDAP permite enlace anónimo. Permite leer `minPwdLength`, `pwdHistoryLength`, `lockoutThreshold`, etc. Requiere construir el Base DN correcto.|`ldapsearch -h 172.16.5.5 -x -b "DC=INLANEFREIGHT,DC=LOCAL" -s sub "*"|
|`net use \\<host>\ipc$ "" /u:""` (Windows)|Establece una sesión nula SMB desde Windows (cuando el servidor lo permite). Permite luego ejecutar enumeraciones SMB/RPC desde un host Windows.|`C:\> net use \\DC01\ipc$ "" /u:""` → "The command completed successfully."|
|`net accounts` (Windows)|Comando integrado de Windows que muestra la política de contraseñas y bloqueo cuando se ejecuta en un equipo con acceso: `Minimum password length`, `Password history`, `Lockout threshold`, `Lockout duration`, etc. Muy útil si ya estás en una máquina Windows del dominio.|`C:\> net accounts` → muestra: `Minimum password length: 8`, `Lockout threshold: 5`, etc.|
|PowerView (`Import-Module .\PowerView.ps1` → `Get-DomainPolicy`)|Módulo PowerShell para enumeración AD desde Windows con privilegios; devuelve la política de dominio en formato estructurado (`MinimumPasswordLength`, `PasswordComplexity`, `LockoutBadCount`, etc.). Ideal cuando se dispone de shell en un host Windows del dominio.|`PS C:\> import-module .\PowerView.ps1` `PS C:\> Get-DomainPolicy`|

| Comando / Herramienta                                                       |                                                                                                                                            Descripción (qué hace / por qué es útil) | Ejemplo (uso concreto)                                                                                              |
| --------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: | ------------------------------------------------------------------------------------------------------------------- |
| `enum4linux -U <host>`                                                      | Enumera usuarios expuestos por SMB (intenta sesión nula). Devuelve lista limpia de cuentas en líneas separadas (`-U` facilita extracción). Útil cuando el DC permite null sessions. | `enum4linux -U 172.16.5.5 \| grep "user:" \| cut -f2 -d"[" \| cut -f1 -d"]"`                                        |
| `rpcclient -U "" -N <DC>` → `enumdomusers`                                  |                                           Conexión RPC/SAMR en sesión nula: `enumdomusers` lista usuarios con sus RIDs. Directo y fiable cuando las null sessions están permitidas. | `rpcclient -U "" -N 172.16.5.5` → `rpcclient $> enumdomusers`                                                       |
| `crackmapexec smb <host> --users`                                           |                                            Enumera usuarios vía SMB y muestra `badpwdcount`/`baddpwdtime`. Muy útil para filtrar cuentas próximas al bloqueo y priorizar objetivos. | `crackmapexec smb 172.16.5.5 --users`                                                                               |
| `ldapsearch -h <DC> -x -b "DC=dom,DC=local" -s sub "(&(objectclass=user))"` |                                                 Usar LDAP (Anonymous Bind si está permitido) para listar `sAMAccountName` y otros atributos. Ideal cuando LDAP admite bind anónimo. | `ldapsearch -h 172.16.5.5 -x -b "DC=INLANEFREIGHT,DC=LOCAL" -s sub "(&(objectclass=user))" \| grep sAMAccountName:` |
| `windapsearch.py --dc-ip <DC> -u "" -U`                                     |                 Herramienta específica para enumerar AD por LDAP/RPC; intenta bind anónimo y enumera usuarios con atributos legibles. Útil para extracción masiva y salida legible. | `./windapsearch.py --dc-ip 172.16.5.5 -u "" -U`                                                                     |
| `kerbrute userenum -d <domain> --dc <DC> <wordlist>`                        |            Valida cuentas por Kerberos (preauth) contra KDC: rápido y eficaz para enumerar usuarios desde un host no autenticado. Menos ruido en algunos entornos que intentos SMB. | `kerbrute userenum -d inlanefreight.local --dc 172.16.5.5 /opt/jsmith.txt`                                          |
| `crackmapexec smb <host> -u <user> -p <pass> --users`                       |                              Con credenciales válidas, obtiene lista de usuarios y metadatos (badpwdcount, última vez). Permite enumeración segura y sin depender de null sessions. | `sudo crackmapexec smb 172.16.5.5 -u htb-student -p 'Academy_student_AD!' --users`                                  |

